<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>PostFile</title>
    <script type="text/javascript" charset="utf-8" src="{{static_url('js/jquery.min.js')}}"></script>
</head>
<body>
    <form>
        <!-- {% module xsrf_form_html() %}-->
        <!--这是一个xsrf保护的方式-->
        <!--<input type="submit" value="登录">-->
        <button id="" onclick="login()">登录</button>
    </form>

    <script>
        function getCookie(name) {
            var cook = document.cookie.match("\\b"+name+"=([^:]*)\\b")
            return cook?cook[1]:undefined
        }
//        console.log(getCookie("_xsrf"))
//        document.getElementById('hi').value=getCookie('_xsrf')

        function login() {
//            $.post("/postxsrf","_xsrf="+getCookie("_xsrf")+"&username="+"sunck"+"passwd="+"1234567",function (data) {
//                alert("ok")
//            })
            data={
                "username":"snuck",
                "passwd":"123456"
            }
            var datastr=JSON.stringify(data)
            $.ajax({
                url:"/postxsrf",
                method:"POST",
                data:datastr,
                success:function (data) {
                    alert("OK")
                },
                headers:{
                    "X－XSRFToken":getCookie('_xsrf')
                }
            })
        }

    </script>
</body>
</html>